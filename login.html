<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" type="image/x-icon" href="/assets/brand-icon.svg">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  
    <link rel="stylesheet" href="./main.css">

    <title>Every Holiday | Login </title>

    <style>
        
        *{
            color: white;
        }
        #box {
    min-height: 80vh;
    width: min(500px, 95%);
    border: 5px solid whitesmoke;
    margin: auto;
    background-color: var(--background-dark);
    overflow: hidden;
    border-radius: 2rem;
    border: 2px solid var(--background-light);
    margin-block: 5rem;
    padding-block: 1rem;
    position: relative;
    transition: transform 0.3s ease-in-out;
}

#box:hover {
    transform: scale(1.05); 
}

   /* hover the animation      */
#watermark {
    position: absolute;
    bottom: -3%;
    right: 2%;
    font-size: 8rem;
    color: var(--background-light);
    opacity: 0.2;
    animation: watermarkAnimation 5s infinite alternate; /* Apply animation */
}

@keyframes watermarkAnimation {
    0% {
        opacity: 0.2;
        transform: translateY(0);
    }
    50% {
        opacity: 5.8; /* Increased brightness */
        transform: translateY(-10px);
    }
    100% {
        opacity: 0.2;
        transform: translateY(0);
    }
}


        .logSignTogle{
            width: 70%;
            margin: 2rem auto;
            display: flex;
            justify-content: flex-start;
            gap:1rem;
        }

        .inactive{
            padding: 0.5em 1.5rem;
            border:1px solid var(--primary);
            background-color: transparent;
            color:var(--primary);
        }
        .main{
            display: flex;
            justify-content: center;
            margin-block: 3rem;
        }
        .main>*{
            width: 70%;
        }
        .signup-page {
            display: none;
        }
        .container > div:nth-child(1){
            width: 400px;
            margin: auto;
        }

        #box input{
            width: 100%;
            padding: 0.5rem 1rem ;
            color:var(--background-dark);
            border-radius: 100px;
            font-size: var(--nav-link);
            border:2px solid transparent;
        }
        #box input:focus{
            border:2px solid var(--background-light);
        }
        #box input[type="submit"]{
            margin-top: 1rem;
            width: auto;
            cursor: pointer !important;
        }
        #box #log,#box #sign{
            color: var(--white);
            border: none;
        }
        #box .form-group {
            margin-bottom: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .form-group label {
            /* flex-basis: 100px; */
           margin-bottom: 0.5rem;
           font-size: var(--paragraph-small);
           text-transform: uppercase;
           letter-spacing: 2px;
        }

        .form-group input {
            flex-grow: 1;
            /* padding: 5px; */
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <img src="./assets/brand-logo.svg" alt="Every Sunday Logo">
            <ul>
                <li><a href="/index.html">Home</a></li>
                <li><a href="/destination.html">Destination</a></li>
                <li><a href="/feedback.html">Feedback</a></li>
                <li><a href="/prices.html">Pricing</a></li>
            </ul>
            <!-- <div id="toggle">
                <label class="switch">
                    <input type="checkbox">
                    <span class="slider round"></span>
                </label>
            </div> -->
            <div id="login-container">
                <a href="./login.html" id="loginBtn"><i class="fa-solid fa-user" id="login-btn"style="font-size: 2rem;"></i></a>
                <div style="display: none;">
                    <a href='./checkout.html'><i class="fa-solid fa-cart-shopping" style="margin-right:1rem;font-size: 2rem;"></i></a>
                    <a href="/" id="logout-btn" class='btn-small' style='border-radius:50px;color:var(--white);font-size: 1.2rem;'>Log Out</a>
                </div>       
            </div>
        </nav>
    </header>
    <main>
        <section class="container">
            
            <div id="box">

                <div class="logSignTogle">
                    <button id="login-btn-form" onclick="showLogin()" class="btn">Login <i class="fa-solid fa-right-to-bracket" style="color:inherit;margin-left:0.5rem;font-size:var(--paragraph-small)"></i></button>
                    <button id="signup-btn" onclick="showSignup()" class="inactive">Signup <i class="fa-solid fa-user-plus" style="color:inherit;margin-left:0.5rem;font-size:var(--paragraph-small)"></i></button>
                </div>
                
                
                <div class="main">
                       <!--login-page  -->
                    <div id="login" class="login-page">      
                        <form id="loginform">
        
                            <div class="form-group">
                                <label for="email1">Email</label>
                                <input type="email" id="email1" name="email1" autocomplete="off" placeholder="Enter email">
                            </div>
        
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input type="password" id="passwordl" name="password" placeholder="Enter password">
                            </div>
        
                            <input type="submit" value="Login" id="log" class="btn">
        
                        </form>
                
                    </div>
                    <!--signup page -->
        
        
                    <div id="signup" class="signup-page">
    
                        <form id="signupform">
        
                            <div class="form-group">
                                <label for="name">Name</label>
                                <input type="text" id="name" name="name" autocomplete="off" placeholder="Enter your name">
                            </div>
        
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" name="email" autocomplete="off" placeholder="Enter email">
                            </div>
                            
                            <div class="form-group">
                                <label for="dob">Date of Birth</label>
                                <input type="date" id="dob" name="dob" autocomplete="off">
                              </div>
                              
                            <div class="form-group">
                                <label for="password">Password</label>
                                <input type="password" id="passwords" name="password" placeholder="Enter password">
                            </div>
        
                            <div class="form-group">
                                <label for="confirm-password">Confirm Password</label>
                                <input type="password" id="confirm-password" name="confirm-password" placeholder="Confirm your password">
                            </div>
        
                            <input type="submit" value="Signup" class="btn" id="sign">
        
                        </form>
                    </div>
                </div>
                <i class="fa-solid fa-users" id="watermark"></i>

            </div>

            <!-- -->
        </section>
    </main>
    <footer>
        <section class="articles"></section>
        <div class="container">
            <h1>Get started and early <span>Update</span> about our package</h1>
            <!-- Copy this searchbox If you want to use it somewhere else -->
            <div class="searchbox">
                <input  type="text" placeholder="Enter your email">
                <button class="btn" id="cta">Get Started</button>
            </input>
            </div>
            <hr>
            <div class="footer">
                <img src="./assets/brand-logo.svg" alt="Every Sunday Logo">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/">Destination</a></li>
                    <li><a href="/">Feedback</a></li>
                    <li><a href="/">Pricing</a></li>
                </ul>
                <p><i class="fa-regular fa-copyright"></i> 2024 Every Holiday-Plan</p>
            </div>
            <div class="socials">
                <div class="social">
                    <a href="https://www.instagram.com/" target="_blank"><i class="fa-brands fa-instagram"></i></a>
                </div>
                <div class="social">
                    <a href="https://twitter.com/" target="_blank"><i class="fa-brands fa-twitter"></i></a>
                </div>
                <div class="social">
                    <a href="https://www.facebook.com/" target="_blank"><i class="fa-brands fa-facebook"></i></a>
                </div>
            </div>
        </div>
    </footer>
    
</body>
<script>
// Function to track user logins for admin panel
function addUserToAdminTracking(username, email) {
    const timestamp = new Date().toISOString();
    const userDetails = {
        username: username,
        email: email,
        loginTime: timestamp
    };
    
    // Get existing users
    const existingUsers = JSON.parse(localStorage.getItem('loggedInUsers') || '[]');
    existingUsers.push(userDetails);
    localStorage.setItem('loggedInUsers', JSON.stringify(existingUsers));
    
    // Update visit count
    const currentVisitCount = parseInt(localStorage.getItem('visitCount') || '0');
    localStorage.setItem('visitCount', (currentVisitCount + 1).toString());
    
    console.log('User tracked for admin panel:', userDetails);
}
</script>
</html>
<script src="main.js"></script>
<script>
    let loginTab=document.getElementById("login");
    let signupTab=document.getElementById("signup");
    let loginTabBtn=document.getElementById("login-btn-form");
    let signupTabBtn=document.getElementById("signup-btn");
    // all  JS code below
    function showLogin() {
        loginTab.style.display = "block";  //  Makes the login tab visible
        signupTab.style.display = "none";  //  Hides the login tab
        signupTabBtn.classList.remove('btn');
        signupTabBtn.classList.add('inactive');
        loginTabBtn.classList.remove('inactive');
        loginTabBtn.classList.add('btn');
    }

    function showSignup() {
        loginTab.style.display = "none";
        signupTab.style.display = "block";
        loginTabBtn.classList.add('inactive');
        loginTabBtn.classList.remove('btn');
        signupTabBtn.classList.remove('inactive');
        signupTabBtn.classList.add('btn');
    }

    let login_data = [];

    async function fetchData() {
        try {
            let res = await fetch("https://mock-every-sunday-server.onrender.com/users");
            let data = await res.json();
            console.log(data);
            login_data = data;
        } catch (err) {
            console.log(err);
        }
    }
    fetchData();

    let form1 = document.getElementById("signupform");
    let name = document.getElementById("name");
    let email = document.getElementById("email");
    let dob=document.getElementById("dob")
    let password = document.getElementById("passwords");
    let confirmPassword = document.getElementById("confirm-password");

    form1.addEventListener("submit", function(event) {
        event.preventDefault();

        if (confirmPassword.value !== password.value) {
            alert("Enter the same characters for password and confirm password fields!");
        } else {
            signup();
        }
    },{once: true});

    async function signup() {
        try {
            let res = await fetch("https://mock-every-sunday-server.onrender.com/users", {  //data is sent to server
                method: "POST",
                body: JSON.stringify({
                    name: name.value,
                    email: email.value,
                    password: password.value,

                    dob: dob.value,
                    imgAvatar : Math.floor((Math.random() * 10)+1)

                  
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            });

            let data = await res.json();
            displayMessage('Account Created','success');
            // Track user signup for admin panel
            addUserToAdminTracking(name.value, email.value);
            fetchData();
        } catch (err) {
            console.log(err);
        }
    }

    let email1 = document.getElementById("email1");
    let passwordLogin = document.getElementById("passwordl");
    let form2 = document.getElementById("loginform");
// console.log(login_data)

form2.addEventListener("submit", function(event) {
  event.preventDefault();

  let flag = false;

  for (let i = 0; i < login_data.length; i++) {
    if (email1.value === login_data[i].email && passwordLogin.value === login_data[i].password) {
      // User logged in successfully.
      flag = true;
      if (email1.value === "admin@admin.com" && passwordLogin.value === "admin") {
        displayMessage('Admin Login Successfull','success');  
        localStorage.setItem('userId', login_data[i].id);
          console.log('Admin logged In');
          setTimeout(()=>{
              window.location.href="admin.html";
          },2000)
    
      } else {
        displayMessage('User Login Successfull','success'); 
        // Track user login for admin panel
        addUserToAdminTracking(login_data[i].name, login_data[i].email);
        // Redirect to the regular user page (change "admin.html" to the appropriate user page).
        localStorage.setItem('userId', login_data[i].id);
        console.log('User logged In'); 
        setTimeout(()=>{
            window.location.href="index.html";
        },2000);
      }
      break;
    }
}

if (!flag) {
    displayMessage('Wrong Credentials! Try Again.','warning');
}
email1.value="";
passwordLogin.value="";
});

</script>
